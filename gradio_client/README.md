# 🔮 周文王占卜系统 - 后端API测试工具

这是一个基于Python Gradio的可视化测试工具，用于测试周文王占卜系统后端服务的各种API功能。

## ✨ 功能特性

- 🏥 **基础检查**: 健康检查、API密钥验证
- 📝 **标准生成**: 测试传统的文本生成API
- 🌊 **流式生成**: 测试Server-Sent Events流式响应
- 🖼️ **视觉分析**: 测试图片上传和AI分析功能
- 🌐 **灵活配置**: 可自定义后端服务地址

## 🚀 快速开始

### 1. 安装依赖

```bash
cd zhouwenwang-divination/gradio_client
pip install -r requirements.txt
```

### 2. 启动测试工具

```bash
# 方式一：使用快速启动脚本
python start.py

# 方式二：直接运行主程序
python backend_tester.py
```

### 3. 打开测试界面

程序启动后会自动在浏览器中打开测试界面：
- 🌐 本地地址: `http://localhost:7860`
- 📡 默认后端: `http://localhost:3001`

## 📋 测试功能详解

### 🏥 基础检查
- **健康检查**: 验证后端服务是否正常运行
- **API密钥验证**: 检查Gemini API密钥配置是否正确

### 📝 标准生成测试
- 测试传统的请求-响应模式
- 输入测试问题，获取完整的AI回复
- 显示响应时间等性能指标

### 🌊 流式生成测试
- 测试实时流式响应功能
- 观察数据流的传输过程
- 实时显示生成内容和统计信息

### 🖼️ 视觉分析测试
- 上传图片进行AI分析
- 支持手相分析等功能
- 测试图片处理和分析能力

## 🔧 配置说明

### 后端服务地址配置

在测试界面中可以修改后端服务地址：
- 默认: `http://localhost:3001`
- 局域网: `http://192.168.1.x:3001`
- 自定义端口: `http://localhost:其他端口`

### 环境要求

- Python 3.8+
- 网络连接到后端服务
- 后端服务已正确配置Gemini API密钥

## 📊 测试结果解读

### ✅ 成功状态
- 绿色✅图标表示测试通过
- 显示详细的响应信息和性能数据
- 包含生成内容和统计信息

### ❌ 失败状态
- 红色❌图标表示测试失败
- 显示具体的错误信息
- 提供故障排除建议

## 🔍 故障排除

### 连接失败
```
❌ 连接失败！请确保后端服务运行在 http://localhost:3001
```
**解决方案**: 
- 检查后端服务是否启动
- 确认端口号是否正确
- 检查防火墙设置

### API密钥验证失败
```
❌ API密钥验证失败！
```
**解决方案**:
- 检查后端的环境变量配置
- 确认`GEMINI_API_KEY`是否正确设置
- 验证API密钥是否有效

### 流式连接问题
```
❌ 流式生成请求失败
```
**解决方案**:
- 检查网络连接稳定性
- 确认后端支持SSE流式响应
- 检查请求频率是否过高

## 📝 使用示例

### 测试六爻占卜
```
问题: 请用六爻占卜为我预测今日运势
期望: 返回详细的卦象解读和运势分析
```

### 测试手相分析
```
操作: 上传手掌图片
问题: 请分析这张手相图片，解读手纹含义
期望: 返回手相特征和命理解读
```

### 测试流式响应
```
问题: 请详细解释六爻占卜的起卦方法和卦象解读
期望: 实时显示生成过程，观察流式数据传输
```

## 🔄 版本信息

- **版本**: 1.0.0
- **兼容后端**: 周文王占卜系统后端服务
- **Python要求**: 3.8+
- **Gradio版本**: 4.0.0+

## 📞 技术支持

如果遇到问题：
1. 检查后端服务状态
2. 验证网络连接
3. 查看错误日志信息
4. 确认依赖包版本

---

**愿AI技术与传统文化的结合，为您的开发测试带来便利！** 🌟 